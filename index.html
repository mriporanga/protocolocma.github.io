<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Protocolos</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .container { max-width: 600px; margin: auto; }
        input, textarea, button { width: 100%; margin: 5px 0; padding: 8px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Sistema de Protocolos</h2>
        <input type="text" id="protocol_number" placeholder="N√∫mero do Protocolo">
        <input type="text" id="author" placeholder="Autor">
        <input type="text" id="recipient" placeholder="Destinat√°rio">
        <textarea id="description" placeholder="Descri√ß√£o"></textarea>
        <button onclick="addProtocol()">Cadastrar</button>
        
        <table>
            <thead>
                <tr>
                    <th>N√∫mero</th>
                    <th>Autor</th>
                    <th>Destinat√°rio</th>
                    <th>A√ß√µes</th>
                </tr>
            </thead>
            <tbody id="protocolTable"></tbody>
        </table>
    </div>
    
    <script>
        let protocols = [];

        function addProtocol() {
            const number = document.getElementById("protocol_number").value;
            const author = document.getElementById("author").value;
            const recipient = document.getElementById("recipient").value;
            const description = document.getElementById("description").value;

            if (!number || !author || !recipient || !description) {
                alert("Preencha todos os campos!");
                return;
            }
            
            const protocol = { number, author, recipient, description, date: new Date() };
            protocols.push(protocol);
            updateTable();
        }

        function updateTable() {
            const table = document.getElementById("protocolTable");
            table.innerHTML = "";
            protocols.forEach((p, index) => {
                table.innerHTML += `<tr>
                    <td>${p.number}</td>
                    <td>${p.author}</td>
                    <td>${p.recipient}</td>
                    <td>
                        <button onclick="printProtocol(${index})">üñ®Ô∏è Imprimir</button>
                        <button onclick="downloadPDF(${index})">üìÑ PDF</button>
                    </td>
                </tr>`;
            });
        }

        function printProtocol(index) {
            const p = protocols[index];
            const printWindow = window.open("", "_blank");
            printWindow.document.write(`
                <html>
                    <body>
                        <h2>Protocolo N¬∫ ${p.number}</h2>
                        <p>Data: ${new Date(p.date).toLocaleString()}</p>
                        <p>Autor: ${p.author}</p>
                        <p>Destinat√°rio: ${p.recipient}</p>
                        <p>Descri√ß√£o: ${p.description}</p>
                    </body>
                </html>
            `);
            printWindow.document.close();
            printWindow.print();
        }

        function downloadPDF(index) {
            const { jsPDF } = window.jspdf;
            const p = protocols[index];
            const doc = new jsPDF();
            doc.text(`Protocolo N¬∫ ${p.number}\nAutor: ${p.author}\nDestinat√°rio: ${p.recipient}\nDescri√ß√£o:\n${p.description}`, 10, 10);
            doc.save(`Protocolo-${p.number}.pdf`);
        }
    </script>
</body>
</html>
